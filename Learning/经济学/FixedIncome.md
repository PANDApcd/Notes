- [Handbook of Fixed Income](#handbook-of-fixed-income)
    - [1. 固定收益市场概述](#1-固定收益市场概述)
        - [1.1 证券属性](#11-证券属性)
        - [1.2 资产风险](#12-资产风险)
        - [1.3 一级市场和二级市场](#13-一级市场和二级市场)
        - [1.4 市场指数](#14-市场指数)
    - [2. 固定收益证券价值分析](#2-固定收益证券价值分析)
        - [2.1 债券定价](#21-债券定价)
        - [2.2 债券收益率计算](#22-债券收益率计算)
        - [2.3 利率风险,久期和凸性](#23-利率风险久期和凸性)
        - [2.4 利率结构分析](#24-利率结构分析)
        - [2.5 基本的债券交易策略](#25-基本的债券交易策略)
        - [2.6 实现收益率计算](#26-实现收益率计算)

# Handbook of Fixed Income
### 1. 固定收益市场概述
##### 1.1 证券属性
- 证券发行: 企业/地方政府/中央政府。
- 风险背书: 抵押物/政府信用/项目收入。
- 债券回购: 企业和地方政府会在利率较低的时候回购旧债发新债。具有回购期权属性的债券对投资者不利,因为价格有上限且利息不稳定。
- 期权属性: 投资者可能有卖出期权,甚至转股和转到其他公司债券的权利,用转换比定价。
- 利息: 固定/基于项目收入/基于市场指标/区间内浮动/设定变动阈值。
- 优先股: 优先股属于分红,但是投资人有税务优惠,因此降低企业的发行成本,<u>优先股几乎都有沉没条款</u>。
- ABS/MBS: 基于房贷收入的债券,通过房贷池分散风险,并且可以进一步划分为基于本金和利息的债券,在低利率环境下回购风险大。
##### 1.2 资产风险
- 市场风险: 固定收益最大的风险,通常源于<u>利率上升</u>导致的价格下降,可以用久期衡量市场风险。
- <u>再投资风险</u>: 发债方会在<u>低利率</u>的时候回购债券,此时很难找到再投资的替代品。
- 赎回风险: 赎回时间的不确定性使得很难给债券定价,并且限制了价格的上涨空间。
- 信用风险: 企业经营不善导致的违约风险和评级公司调节评级带来的价格波动风险。
- 流动性风险: 流动性差的债券很难快速变现。
- <u>波动率风险</u>: 有期权属性的债券对于市场波动率会很敏感。
- 其他风险: 汇率/政治/法律/购买力/黑天鹅/产业风险。
##### 1.3 <u>一级市场和二级市场</u>
- 一级市场发行: 投行协助发行方给债券定价并承销给市场,为了降低风险,投行会成团一起承销,通常有买断发行和竞标发行两种方法。
- SEC发行法规: 发行前先要在SEC注册,但是两年内不用反复注册。<u>144A免除了私人发行发行2年内不能转售和必须注册的条款,吸引了大量国际投资者</u>。
- 私人市场发行: 不能对大众宣传,可以免除一定注册条款。投资者可以和发行方商讨债券的属性细节,但是因为流动性差,风险也高。
- <u>二级市场</u>: 交易员基于面值比率报价,通常假设面值是100。现在大部分交易依然通过和dealer的点对点报价在OTC执行。美国债券是T+2交易,包括达成价格共识,资金和证券清算转账,并通过TRACE报备。
##### 1.4 市场指数
- 市场规模: 债券市场总市值和权益市场大致相等,但是历史只有50年左右,也没有成熟的电子交易系统,只有30%的交易完全电子化。
- 市场多样性: 由于债券的属性繁多,市场里有大量不同的投资标的,因此很难做出全面具有代表性的指数来评估中性表现。
- IG指数: 由BBB及以上债券构成的指数,通常是市值加权,并由交易员报价来计算每个成分的价格。指数内不同评级的债券收益率相关性很大,因为利率几乎是唯一变量。
- HY指数: 由BBB之下债券构成的指数,因为HY债券经常违约,且流动性差,更难计算价格。<u>HY种类内部债券相关性同样很大,但是和IG指数相关性很低</u>。
### 2. 固定收益证券价值分析
##### 2.1 <u>债券定价</u>
- 常规债券定价: 选择合适的折现率(通常用对应时间的无风险利率),把每一笔现金流当做0息债券进行折现。<u>当无期权债券折现率等于利率时,价格等于债券面值</u>。
- <u>期中债券定价</u>: 因为债券利息是定期支付的,在期中交易的话要公平的分配应计利息。
  1. 计算距离下一次付息日的天数差$n$,国债用实际天数,企业债和地方债则统一把每个月当做30天处理。
  2. 计算折现日期比$w=\frac{n}{P}$, $P$是付息周期长度。
  3. <u>用折现法并带入$w$计算dirty price / full price,这个价格把卖家应得的利息也一起算进去了</u>。
   $$P=\sum_{i=0}^{n-1}\frac{c}{(1+r)^{i+w}}+\frac{\text{Par}}{(1+r)^{n-1+w}}$$
  4. 计算应计利息$AI=C\frac{P-n}{P}$, clean price就是dirty price减去应急利息$P_c=P-AI$
- 报价习惯: 美国通常用clean price报价,但是支付dirty price,因为dirty price假设利息全在付息日支付买方而卖方没有利息。
##### 2.2 债券收益率计算
- 当前收益率 Current Yield: 利息除以当前债券价格,简单方便,但是没有考虑到本金和再投资因素。
$$Y_{\text{current}}=\frac{C}{P}$$
- 到期收益率YTM: 找到使得债券现值等于当前市场报价的折现率。<u>这个收益率假设了再投资收益率等于YTM,没有考虑再投资风险,因此会高估价格</u>。
$$r\rightarrow P(r)=P$$
- 赎回收益率YTC: 假设债券在第一个可赎回日到期赎回,计算使得折现价格等于现价的折现率,同样没有考虑再投资风险。
- 浮动利率债券收益率: 假设未来浮动利率不变计算现金流和YTM,获得YTM减去标定利率的spread。缺陷在于没有考虑浮动利率的变化和利息上下限。
- <u>全收益分析</u>: 定义投资时长,再投资利率(可以通过远期利率获得)和投资到期日出售价格来重新计算现金流,同时可以考虑税务问题。<u>适合做网格分析来获得各种情况的收益率分析并对比不同债券的表现</u>。
- <u>投资组合全收益计算</u>: 不能直接对所有成分债券的收益率进行加权,而是<u>重新计算所有的现金流折现加权计算</u>。
##### 2.3 <u>利率风险,久期和凸性</u>
- 利率风险: 令函数$P(r)$描述债券在利率是$r$时的价格,获得在不同$r$情况下的$P(r)$价格变化比例,用于评估对于利率变动的风险。
- <u>久期</u>: $P(r)$对于$r$的斜率,<u>利息越高/到期时间越长/$r$越小,久期越大</u>。通常选取一个20bp左右的$\Delta r$来计算久期
$$D=\frac{P(r-\Delta r) - P(r-\Delta r)}{2P(r)\Delta r}$$
- <u>凸性: </u>因为久期线性逼近误差较大,考虑凸性作为二阶拟合。在不受赎回债券影响的情况下,通常凸性为正数,<u>同时凸性越大的债券,在利率变动相同时,涨的比跌的更多</u>。
$$C=\frac{P(r-\Delta r) + P(r-\Delta r)-2P(r)}{P(r)\Delta r^2}$$
- <u>债券价格变化率的近似逼近</u>: 把久期当做斜率,凸性当做二阶导,来考虑$P(r)$的变化,注意要考虑单位影响。
$$P(r)=-D\Delta r+\frac{1}{2}C\Delta r^2$$
- PVBP/DV01: 在利率变化为1bp的情况下$P(r)$的变化量,因为范围小,通常用久期表示就够了,不需要考虑凸性。
- </u>召回期权影响</u>: 债券还要减去买入集权的价值,因此<u>在利率下降时,凸性变为负数,价格不会继续上升</u>,整个价格曲线为反向的S型
- 卖出期权影响: 债券还包含了卖出期权的价值,因此在利率上升时,凸性变大,价格不会进一步下跌
- 麦考利久期/修正久期/修正凸性: 假设现金流不会因利率改变,只修改折现率重新计算的久期和凸性,可以用于简化计算,但在含有期权属性时不准。
$$\text{Macaulay Duration}=\frac{\sum_{i=1}^n\frac{CF_i}{r^i}}{n\cdot P}$$
$$\text{Modified Duration}=\text{Macaulay Duration}\frac{1}{1+\text{YTM}/n}$$
- <u>投资组合久期</u>: 投资组合的久期是各个债券久期的市值加权,并且还要考虑到利差久期的计算。
- 浮动利率债券: 距离债券重置日期的天数越多,久期越大,同时还要考虑投资者对利差的需求和利息上限的影响。
##### 2.4 <u>利率结构分析</u>
- <u>基准利率(现货利率): 国债收益率无法直接作为基准利率,因为利息通过短期利率折现了</u>,因此需要先从最短期国债出发获得短期收益率,折现长期国债利息后,再计算对应的长期现货利率。
- 风险溢价: 基准利率之上的额外利率,取决于发行方信用,债券流动性,税务关系,评级,债券到期时间和附带的期权属性。
- <u>远期利率</u>: 在没有套利和交易摩擦的情况下,$t_0\sim t_2$的利率$r_{0\sim2}$应该等于子区间利率的乘积$r_{0\sim1}\cdot r_{1\sim2}$,因为通常已知从$t_0$开始的利率,所以可以估计远期利率$r_{1\sim 2}=\frac{r_{0\sim2}}{r_{0\sim1}}$
- <u>利率之间的关系</u>: 现货利率是远期利率的几何平均数,基准利率是现货利率现金流加权后的结果,因此波动以此减小
- 决定长期利率的因素: 由于这些因素不会完全包含在远期利率中,因此可能造成远期利率估计误差
  - 市场期望: 基于正确的远期利率期望出发,构造的长期利率
  - 时间风险溢价: 基于债券的beta/到期时间带来的风险,会受到投资者风险偏好的影响。<u>经济过热,利率曲线陡峭时会上升,在经济下挫,债券作为避险属性的情况下会下降,甚至为负数</u>。
  - 凸性偏好: 长期无权债券凸性很大,带来投资优势,在波动率高的市场会进一步放大,因此导致收益率降低。
##### 2.5 基本的债券交易策略
- 流动性控制: 使用全收益分析找到和当前债券在评级,收益率等性质上相似的流动性强的债券来替换组合中的流动性差的债券。
- 对未来利率预期/利差和市场不同,因此可以计算基于自己预期下的债券价格,并进行低买高卖。
- 找到<u>远期利率中被错误定价</u>的部分,例如认为$t_1\sim t_2$期间利率定价过高,则可以通过做多$t_0\sim t_2$,做空$t_0\sim t_1$让自己仅暴露在$t_1\sim t_2$的利率变化中
- 在利率曲线陡峭的时候进行<u>久期中性套利</u>: 在长期债券利率和中期利率近似的情况下,做空短期和长期利率,做多中期债券,在久期不变的情况下,提高综合收益率。
##### 2.6 实现收益率计算
- 流动性问题: 当因为流动性不好而无法对成分债券进行合理定价时,最好选择相似且流动性好的债券的价格替换。
- 投资收益率: 可以考虑在投资阶段客户投入资金/取出资金对收益率的影响,但是没有具体考虑客户入金/出金的时点
$$\text{ROI}=\frac{(\text{EndMarketValue}+\text{NetOutCash})-(\text{BeginMarketValue}+\text{NetInCash})}{\text{BeginMarketValue}+\text{NetInCash}}$$
- <u>金钱加权收益率 (MWR)</u>: 综合评估投资组合表现,反应了客户的体验
  1. 对于每一笔现金流$M_i$,计算它在整个计算周期中被用于投资的日期的比例$n_i$,如果是一开始就在组合中的话则$n_i=1$
  2. 带入每一笔现金流价格和时间比率,找到使得终值为EndMarketValue的MWR,这里假设了MWR在整个投资周期中不变。
    $$\sum M_i(1+\text{MWR})^{n_i}=\text{EndMarketValue}$$
  3. 用 Modiﬁed Dietz Return作为MWR的近似简便计算
    $$R=\frac{\text{EndMarketValue}-\text{BeginMarketValue}-\text{TotalNetCashFlow}}{\text{BeginMarketValue}+\sum n_i\cdot\text{NetCashFlow}_i}$$
- <u>时间加权收益率 (TWR)</u>: 在每一次客户入金和出金的时候计算子区间收益率,并累成获得综合收益率。适合单独评估经理的投资表现,排除了客户的影响。在计算成本高的时候可以牺牲精度扩大子区间范围,并用子区间$MWR$近似。